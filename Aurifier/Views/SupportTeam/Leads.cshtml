
@model Aurifier.Models.LeadViewModel

@{
    ViewBag.Title = "Leads";
    Layout = "~/Views/Shared/SupportLayout.cshtml";
}

<h2>Leads</h2>
<script src="~/Scripts/jquery-1.10.2.min.js"></script>
<script src="~/Scripts/bootstrap.min.js"></script>
<link href="~/Content/bootstrap.min.css" rel="stylesheet" />

<div class="container" style="margin-top:3%">
    <a href="#" class="btn btn-info" onclick="AddNewLead(0)">Add New Leads</a> <br /><br />
    <table id="myTable" class="table table-striped">
        <thead>
            <tr>
                <th>Lead_Id</th>
                <th>LeadName</th>
                <th>Company</th>
                <th>Address</th>
                <th>Mail_Id</th>
                <th>MobileNumber</th>
                @*<th>GeneratedBy</th>
                <th>Team</th>
                <th>Manager</th>
                <th>Roles</th>
                <th>Employee</th>
                <th>Date</th>
                <th>Time</th>*@
                <th>View More</th>
                <th>Edit</th>
                <th>Delete</th>

            </tr>

        </thead>
        <tbody id="SetLeadList">
            <tr id="LoadingStatus" style="color:red"></tr>
        </tbody>
    </table>
    <div class="modal fade" id="MyModal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <a href="#" class="close" data-dismiss="modal">&times;</a>
                    <h4 id="ModalTitle"></h4>
                </div>
                <div class="modal-body">
                    <form id="form">
                        <fieldset id="SubmitForm">
                            @Html.HiddenFor(m => m.Lead_Id, new { @id = "LeadId" })
                            <div class="form-group">
                                @Html.TextBoxFor(m => m.LeadName, new { @id = "LName", @class = "form-control", @placeholder = "Lead Name*" })
                            </div>
                            <div class="form-group">
                                @Html.TextBoxFor(m => m.Company, new { @id = "Company", @class = "form-control", @placeholder = "Company*" })
                            </div>
                            <div class="form-group">
                                @Html.TextBoxFor(m => m.Address, new { @id = "Address", @class = "form-control", @placeholder = "Address*" })
                            </div>
                            <div class="form-group">
                                @Html.TextBoxFor(m => m.Mail_Id, new { @id = "Email", @class = "form-control", @placeholder = "Email*" })
                            </div>
                            <div class="form-group">
                                @Html.TextBoxFor(m => m.MobileNumber, new { @id = "MNumber", @class = "form-control", @placeholder = "MobileNumber*" })
                            </div>

                            @*<div class="form-group">
                                    @Html.LabelFor(m => m.GeneratedBy, new { @id = "GeneratedBy", @class = "form-control", @placeholder = "GeneratedBy*" })
                                </div>*@
                            <div class="form-group">
                                @Html.DropDownListFor(m => m.Team_Id, ViewBag.Team as SelectList, "--Select Team--", new { @id = "ddlTeamId", @class = "form-control" })
                            </div>
                            <div class="form-group">
                                @Html.TextBoxFor(m => m.Manager, new { @id = "Manager", @class = "form-control", @placeholder = "Manager*" })
                            </div>
                           
                              <div>
                                    @Html.DropDownList("dropdownRole", new SelectList(string.Empty, "Value", "Text"), "Please select a Role", new { @style = "width:250px;" })
                                </div>
                                <div style="margin-top:50px;">
                                    @Html.DropDownList("dropdownUserName", new SelectList(string.Empty, "Value", "Text"), "Please select a UserName", new { @style = "width:250px;" })
                                </div>
                            
                            <div class="form-group">
                                @Html.TextBoxFor(m => m.Date, new { @id = "Date", @class = "form-control", @placeholder = "Date*" })
                            </div>
                            <div class="form-group">
                                @Html.TextBoxFor(m => m.Time, new { @id = "Time", @class = "form-control", @placeholder = "Time*" })
                            </div>
                            <div class="form-group">
                                @Html.TextBoxFor(m => m.Descreption, new { @id = "Description", @class = "form-control", @placeholder = "Description*" })
                            </div>
                            <div class="form-group">
                                <a href="#" class="btn btn-block btn-danger" id="SaveEmployeeRecord">Save</a>
                            </div>

                        </fieldset>
                    </form>
                </div>
            </div>
        </div>
    </div>
<div class="modal fade" id="MyModal1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <a href="#" class="close" data-dismiss="modal">&times;</a>
                <h4 id="ModalTitle1"></h4>
            </div>
            <div class="modal-body">
                <form id="form1">
                    
                        @Html.HiddenFor(m => m.Lead_Id, new { @id = "LeadId1" })
                        <div class="form-group">
                            
                            @*<label>@Html.DisplayFor(m=>m.LeadName,new { @id="FName1",@class="form-control"} )</label>*@
                            @Html.LabelFor(m => m.LeadName, new { @id = "FName1", @class = "form-control"})
                        </div>
                        <div class="form-group">
                            @Html.LabelFor(m => m.Company, new { @id = "LName1", @class = "form-control"})
                        </div>
                        @*<div class="form-group">
                            @Html.LabelFor(m => m.UserName, new { @id = "UName1", @class = "form-control" })
                        </div>*@
                        <div class="form-group">
                            @Html.LabelFor(m => m.Address, new { @id = "Email1", @class = "form-control" })
                        </div>
                        <div class="form-group">
                            @Html.LabelFor(m => m.Mail_Id, new { @id = "MailId", @class = "form-control" })
                        </div>
                        <div class="form-group">
                            @Html.LabelFor(m => m.MobileNumber, new { @id = "MNumber1", @class = "form-control"})
                        </div>
                        
                        @*<div class="form-group">
                            @Html.DropDownListFor(m => m.TeamId, ViewBag.Team as SelectList, "--Select Team--", new { @id = "ddlTeam1", @class = "form-control" })
                        </div>*@
                        <div class="modal-footer">
                             <a href="#" class="btn btn-primary" data-dismiss="modal">Cancel</a>
                         </div>
                </form>
            </div>
        </div>
    </div>
</div>
    <script>
        $("#LoadingStatus").html("Loading....");
        $.get("/SupportTeam/getLead", null, DataBind);
        function DataBind(LeadList) {
            //This Code For Receive All Data From Controller And Show It In Client Side
            debugger;
            var SetData = $("#SetLeadList");
            for (var i = 0; i < LeadList.length; i++) {
                var Data = "<tr class='row_" + LeadList[i].Lead_Id + "'>" +
                    "<td>" + LeadList[i].Lead_Id + "</td>" +
                    "<td>" + LeadList[i].LeadName + "</td>" +
                    "<td>" + LeadList[i].Company + "</td>" +
                    "<td>" + LeadList[i].Address + "</td>" +
                    "<td>" + LeadList[i].Mail_Id + "</td>" +
                    "<td>" + LeadList[i].MobileNumber + "</td>" +
                    "<td>" + "<a href='#' class='btn btn-primary' onclick='ViewMoreRecord(" + LeadList[i].Lead_Id + ")'><span class='glyphicon glyphicon-plus'></span></a>" + "</td>" +
                    //"<td>" + LeadList[i].GeneratedBy + "</td>" +
                    //"<td>" + LeadList[i].TeamNumber + "</td>" +
                    //"<td>" + LeadList[i].Manager + "</td>" +
                    //"<td>" + LeadList[i].Roles_Name + "</td>" +
                    //"<td>" + LeadList[i].UserName + "</td>" +
                    //"<td>" + LeadList[i].Date + "</td>" +
                    //"<td>" + LeadList[i].Time + "</td>" +
                    //"<td>" + LeadList[i].Descreption + "</td>" +
                    "<td>" + "<a href='#' class='btn btn-success' onclick='EditLeadRecord(" + LeadList[i].Lead_Id + ")' ><span class='glyphicon glyphicon-pencil'></span></a>" + "</td>" +
                    "<td>" + "<a href='#' class='btn btn-danger' onclick='DeleteLeadRecord(" + LeadList[i].Lead_Id + ")'><span class='glyphicon glyphicon-remove'></span></a>" + "</td>" +
                    "</tr>";

                SetData.append(Data);
                $("#LoadingStatus").html(" ");

            }

        }
        //Modal for add new Lead
        function AddNewLead(Lead_Id) {
            $("#form")[0].reset();
            $("#Lead_Id").val(0);
            $("#ddlTeamId option:selected").text("--Select Team--");
            $("#ddlRoleId option:selected").text("--Select Role--");
            $("#ddlUserName option:selected").text("--Select UserName--");
            $("#ModalTitle").html("Add New Lead");
            $("#MyModal").modal();

        }
        function ViewMoreRecord(Lead_Id) {
            var url = "/SupportTeam/getEmployeeById?LeadId=" + Lead_Id;
            $("#ModalTitle1").html("View Lead");
            $("#MyModal1").modal();
            $.ajax({
                type: "GET",
                url: url,
                success: function (data) {
                    var obj = JSON.parse(data);
                    debugger;
                    $("#LeadId1").val(obj.Lead_Id);
                    $("#FName1").val(obj.LeadName);
                    $("#LName1").val(obj.Company);
                    //$("#UName1").val(obj.Address);
                    $("#Email1").val(obj.Address);
                    $("#MailId").val(obj.Mail_Id);
                    $("#MNumber1").val(obj.MobileNumber);
                    //$("#ddlRole1").val(obj.Roles_Id);
                    //$("#ddlTeam1").val(obj.TeamId);
                    //$("#ddlRole option:selected").text(obj.Role.Roles_Name);
                    //$("#ddlRole option:selected").val(obj.Roles_Id);
                    //$("#ddlTeam option:selected").text(obj.TeamsTable.TeamNumber);
                    //$("#ddlTeam option:selected").val(obj.TeamId);
                }
            })
        }

        $(function () {
            $.ajax({
                type: "GET",
                url: "/SupportTeam/GetRoles",
                datatype: "Json",
                success: function (data) {
                    $.each(data, function (index, value) {
                        $('#dropdownRole').append('<option value="' + value.RolesId + '">' + value.Roles_Name + '</option>');
                    });
                }
            });

            $('#dropdownRole').change(function () {

                $('#dropdownUserName').empty();

                $.ajax({
                    type: "POST",
                    url: "/SupportTeam/GetUserNameByRolesId",
                    datatype: "Json",
                    data: { roleId: $('#dropdownRole').val() },
                    success: function (data) {
                        $.each(data, function (index, value) {
                            $('#dropdownUserName').append('<option value="' + value.EmpId + '">' + value.UserName + '</option>');
                        });
                    }
                });
            });
        });
    </script>
    @*<script src="~/Scripts/jquery-1.10.2.min.js"></script>
    <script>
        $(document).ready(function () {
            debugger;
            $("#RolesId").change(function () {
                $.get("/SupportTeam/getUserNameList", { RolesId: $("#RolesId").val() }, function (data) {
                    $("#EmpId").empty();
                    $.each(data, function (index, row) {
                        $("#EmpId").append("<option value='" + row.EmpId + "'>" + row.UserName + "</option>")
                    });
                });
            })
        });

    </script>*@
